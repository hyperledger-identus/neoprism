# Code generated by Python script. DO NOT EDIT.
services:
  bf-proxy:
    image: caddy:2.10.2
    ports:
    - 18082:3000
    restart: always
    volumes:
    - ./Caddyfile-blockfrost:/etc/caddy/Caddyfile
  bf-ryo:
    depends_on:
      bootstrap-testnet:
        condition: service_completed_successfully
      db-dbsync:
        condition: service_healthy
    environment:
      BLOCKFROST_CONFIG_DBSYNC_DATABASE: postgres
      BLOCKFROST_CONFIG_DBSYNC_HOST: db-dbsync
      BLOCKFROST_CONFIG_DBSYNC_PASSWORD: postgres
      BLOCKFROST_CONFIG_DBSYNC_PORT: '5432'
      BLOCKFROST_CONFIG_DBSYNC_USER: postgres
      BLOCKFROST_CONFIG_GENESIS_DATA_FOLDER: /node/testnet
      BLOCKFROST_CONFIG_NETWORK: custom
      BLOCKFROST_MITHRIL_ENABLED: 'false'
      NODE_ENV: development
    image: blockfrost/backend-ryo:v4.3.0
    restart: always
    volumes:
    - ./ryo.yaml:/app/config/development.yaml
    - node-testnet:/node/testnet
  bootstrap-testnet:
    command:
    - bash
    - -c
    - 'transactGenesis

      hurl ./init-wallet.hurl

      hurl ./init-did.hurl


      # blockfrost-ryo expects a different location

      cp testnet/conway-genesis.json testnet/genesis.json

      cp testnet/byron-genesis.json testnet/byron_genesis.json

      '
    depends_on:
      cardano-node:
        condition: service_healthy
    environment:
      CARDANO_NODE_NETWORK_ID: '42'
      CARDANO_NODE_SOCKET_PATH: /node/testnet/socket/node1/sock
      GENESIS_PAYMENT_ADDR: addr_test1qp83v2wq3z9mkcjj5ejlupgwt6tcly5mtmz36rpm8w4atvqd5jzpz23y8l4dwfd9l46fl2p86nmkkx5keewdevqxhlyslv99j3
      HURL_WALLET_BASE_URL: http://cardano-wallet:8090/v2
      HURL_WALLET_PASSPHRASE: super_secret
    image: patextreme/cardano-testnet:20251111-145358
    volumes:
    - node-testnet:/node/testnet
    - ./init-wallet.hurl:/node/init-wallet.hurl
    - ./init-did.hurl:/node/init-did.hurl
  cardano-dbsync:
    command:
    - --config
    - /config/dbsync-config.yaml
    - --socket-path
    - /node/testnet/socket/node1/sock
    - --force-indexes
    depends_on:
      cardano-node:
        condition: service_healthy
      db-dbsync:
        condition: service_healthy
    environment:
      POSTGRES_DB: postgres
      POSTGRES_HOST: db-dbsync
      POSTGRES_PASSWORD: postgres
      POSTGRES_PORT: '5432'
      POSTGRES_USER: postgres
    image: ghcr.io/intersectmbo/cardano-db-sync:13.6.0.5
    restart: always
    volumes:
    - node-testnet:/node/testnet
    - ./dbsync-config.yaml:/config/dbsync-config.yaml
  cardano-node:
    command:
    - initTestnet
    environment:
      CARDANO_NODE_NETWORK_ID: '42'
      CARDANO_NODE_SOCKET_PATH: /node/testnet/socket/node1/sock
    healthcheck:
      interval: 2s
      retries: 30
      test:
      - CMD-SHELL
      - cardano-cli query tip
      timeout: 5s
    image: patextreme/cardano-testnet:20251111-145358
    volumes:
    - node-testnet:/node/testnet
  cardano-submit-api:
    command:
    - --config
    - /config.yaml
    - --socket-path
    - /node/testnet/socket/node1/sock
    - --testnet-magic
    - '42'
    - --listen-address
    - 0.0.0.0
    depends_on:
      cardano-node:
        condition: service_healthy
    image: ghcr.io/intersectmbo/cardano-submit-api:10.5.3
    restart: always
    volumes:
    - node-testnet:/node/testnet
    - ./cardano-submit-api.yaml:/config.yaml
  cardano-wallet:
    command:
    - bash
    - -c
    - "cardano-wallet serve \\\n  --database /wallet/db \\\n  --node-socket /node/testnet/socket/node1/sock\
      \ \\\n  --testnet /node/testnet/byron-genesis.json \\\n  --listen-address 0.0.0.0\n"
    depends_on:
      cardano-node:
        condition: service_healthy
    entrypoint: []
    healthcheck:
      interval: 2s
      retries: 30
      test:
      - CMD-SHELL
      - cardano-wallet network information
      timeout: 5s
    image: cardanofoundation/cardano-wallet:2025.12.15
    ports:
    - 18081:8090
    restart: always
    volumes:
    - node-testnet:/node/testnet
  db-dbsync:
    environment:
      POSTGRES_DB: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
    healthcheck:
      interval: 2s
      retries: 30
      test:
      - CMD
      - pg_isready
      - -U
      - postgres
      timeout: 5s
    image: postgres:16
    restart: always
  db-neoprism:
    environment:
      POSTGRES_DB: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
    healthcheck:
      interval: 2s
      retries: 30
      test:
      - CMD
      - pg_isready
      - -U
      - postgres
      timeout: 5s
    image: postgres:16
    restart: always
  neoprism-standalone:
    command:
    - standalone
    depends_on:
      cardano-wallet:
        condition: service_healthy
      db-neoprism:
        condition: service_healthy
    environment:
      NPRISM_BLOCKFROST_API_KEY: ''
      NPRISM_BLOCKFROST_BASE_URL: http://bf-proxy:3000
      NPRISM_BLOCKFROST_POLL_INTERVAL: 1s
      NPRISM_CARDANO_NETWORK: custom
      NPRISM_CARDANO_WALLET_BASE_URL: http://cardano-wallet:8090/v2
      NPRISM_CARDANO_WALLET_PASSPHRASE: super_secret
      NPRISM_CARDANO_WALLET_PAYMENT_ADDR: addr_test1qp83v2wq3z9mkcjj5ejlupgwt6tcly5mtmz36rpm8w4atvqd5jzpz23y8l4dwfd9l46fl2p86nmkkx5keewdevqxhlyslv99j3
      NPRISM_CARDANO_WALLET_WALLET_ID: 9263a1248b046fe9e1aabc4134b03dc5c3a7ee3d
      NPRISM_CONFIRMATION_BLOCKS: '0'
      NPRISM_DB_URL: postgres://postgres:postgres@db-neoprism:5432/postgres
      NPRISM_EXTERNAL_URL: http://localhost:18080
      NPRISM_INDEX_INTERVAL: 1s
      RUST_LOG: oura=warn,tracing::span=warn,info
    healthcheck:
      interval: 2s
      retries: 30
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8080/api/_system/health
      timeout: 5s
    image: identus-neoprism:latest
    ports:
    - 18080:8080
    restart: always
volumes:
  node-testnet: {}
